<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>One World One Centre â€” Intake Wizard & Yellow Form</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- html2pdf for one-click PDF export -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>
  <style>
    /* Small helpers */
    .field-gap{gap:12px}
    .disabled-input{background:#f3f4f6;color:#6b7280}
    
    /* Final yellow sheet styling */
    .yellow-bg {
      background-color: #FFF9C4;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      width: 100%;
      max-width: 800px;
      margin: 0 auto;
    }

    .checkbox-box {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 1px solid #111;
      text-align: center;
      line-height: 18px;
      font-weight: 700;
      margin-right: 6px;
    }
    
    .muted {
      color: #6b7280;
    }

    table {
      width: 100%;
      border-collapse: collapse;
    }

    td {
      padding: 8px;
      border: 1px solid #ddd;
      vertical-align: top;
    }

    .header {
      background-color: #f0f0f0;
      font-weight: bold;
      width: 40%;
    }

    .content {
      width: 60%;
    }

    .final-buttons {
      display: flex;
      justify-content: space-between;
      margin-top: 20px;
    }

    @media print {
      body { margin: 0; }
      .wizard { display: none; }
      .final-wrap { display: block; }
    }
  </style>
</head>
<body class="bg-gray-100 text-gray-800">
  <div class="max-w-5xl mx-auto p-6">
    <!-- FINAL STATIC YELLOW FORM -->
    <div id="finalWrap" class="final-wrap hidden mt-6">
      <div id="finalArea" class="yellow-bg p-6 rounded shadow border">
        <!-- Content injected here -->
        <table>
          <tr>
            <td class="header">DATE</td>
            <td class="content" id="finalDate"></td>
          </tr>
          <tr>
            <td class="header">TAKEN BY</td>
            <td class="content" id="finalTakenBy"></td>
          </tr>
          <tr>
            <td class="header">CONTACT NAME / SURNAME</td>
            <td class="content" id="finalContactName"></td>
          </tr>
          <tr>
            <td class="header">CONTACT PHONE #</td>
            <td class="content" id="finalContactPhone"></td>
          </tr>
          <tr>
            <td class="header">CONTACT RELATION</td>
            <td class="content" id="finalContactRel"></td>
          </tr>
          <tr>
            <td class="header">STUDENT'S STATUS</td>
            <td class="content" id="finalStudentStatus"></td>
          </tr>
          <tr>
            <td class="header">IMMIGRATION DOCUMENT</td>
            <td class="content" id="finalImmDoc"></td>
          </tr>
          <tr>
            <td class="header">EXPIRY DATE (RC/SP/WP)</td>
            <td class="content" id="finalExpiryDate"></td>
          </tr>
          <tr>
            <td class="header">PREVIOUS ATTENDANCE IN CANADIAN SCHOOLS?</td>
            <td class="content" id="finalPrevAttend"></td>
          </tr>
          <tr>
            <td class="header">DATE STUDENT(S) LANDED IN CANADA</td>
            <td class="content" id="finalLanded"></td>
          </tr>
          <tr>
            <td class="header">FATHER'S SURNAME</td>
            <td class="content" id="finalFatherSurname"></td>
          </tr>
          <tr>
            <td class="header">FATHER'S GIVEN NAME</td>
            <td class="content" id="finalFatherGiven"></td>
          </tr>
          <tr>
            <td class="header">MOTHER'S SURNAME</td>
            <td class="content" id="finalMotherSurname"></td>
          </tr>
          <tr>
            <td class="header">MOTHER'S GIVEN NAME</td>
            <td class="content" id="finalMotherGiven"></td>
          </tr>
          <tr>
            <td class="header">FAMILY ADDRESS</td>
            <td class="content" id="finalAddress"></td>
          </tr>
          <tr>
            <td class="header">POSTAL CODE</td>
            <td class="content" id="finalPostalCode"></td>
          </tr>
          <tr>
            <td class="header">FAMILY PHONE #</td>
            <td class="content" id="finalFamilyPhone"></td>
          </tr>
          <tr>
            <td class="header">HOME LANGUAGE</td>
            <td class="content" id="finalHomeLang"></td>
          </tr>
          <tr>
            <td class="header">CATHOLIC</td>
            <td class="content" id="finalCatholic"></td>
          </tr>
          <tr>
            <td class="header">STUDENT(S)</td>
            <td class="content" id="finalStudents"></td>
          </tr>
        </table>

        <div class="final-buttons">
          <button id="printBtn" class="px-4 py-2 bg-blue-600 text-white rounded" onclick="window.print()">Print</button>
          <button id="pdfBtn" class="px-4 py-2 bg-indigo-600 text-white rounded">Download PDF</button>
          <button id="editBtn" class="px-4 py-2 bg-gray-500 text-white rounded">Back to Edit</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Function to fill the form with data from the wizard
    function generateFinal() {
      // Fill final table content
      document.getElementById("finalDate").innerText = document.getElementById("date").value;
      document.getElementById("finalTakenBy").innerText = document.getElementById("takenBy").value;
      document.getElementById("finalContactName").innerText = document.getElementById("contactName").value;
      document.getElementById("finalContactPhone").innerText = document.getElementById("contactPhone").value;
      document.getElementById("finalContactRel").innerText = document.getElementById("contactRel").value;
      document.getElementById("finalStudentStatus").innerText = getRadioValue('studentStatus');
      document.getElementById("finalImmDoc").innerText = getRadioValue('immDoc');
      document.getElementById("finalExpiryDate").innerText = document.getElementById("expiry").value;
      document.getElementById("finalPrevAttend").innerText = getRadioValue('prevAttend');
      document.getElementById("finalLanded").innerText = document.getElementById("landed").value;
      document.getElementById("finalFatherSurname").innerText = document.getElementById("fatherSurname").value;
      document.getElementById("finalFatherGiven").innerText = document.getElementById("fatherGiven").value;
      document.getElementById("finalMotherSurname").innerText = document.getElementById("motherSurname").value;
      document.getElementById("finalMotherGiven").innerText = document.getElementById("motherGiven").value;
      document.getElementById("finalAddress").innerText = document.getElementById("address").value;
      document.getElementById("finalPostalCode").innerText = document.getElementById("postal").value;
      document.getElementById("finalFamilyPhone").innerText = document.getElementById("familyPhone").value;
      document.getElementById("finalHomeLang").innerText = document.getElementById("homeLang").value;
      document.getElementById("finalCatholic").innerText = getRadioValue('catholic');

      // Students section (if any students exist)
      let studentsHtml = "";
      for (let i = 1; i <= studentCount; i++) {
        const surname = document.getElementById(`s_${i}_surname`).value || '';
        const given = document.getElementById(`s_${i}_given`).value || '';
        studentsHtml += `<strong>STUDENT ${i}:</strong> ${surname}, ${given}<br>`;
      }
      document.getElementById("finalStudents").innerHTML = studentsHtml;

      // Hide wizard and show final form
      document.getElementById('wizardRoot').classList.add('hidden');
      document.getElementById('finalWrap').classList.remove('hidden');
    }

    // Get radio button value
    function getRadioValue(name) {
      const r = document.querySelector(`input[name='${name}']:checked`);
      return r ? r.value : '';
    }

    // PDF button logic
    document.getElementById('pdfBtn').onclick = () => {
      const opt = { margin: 0.2, filename: 'one-world-one-centre-intake.pdf', image: { type: 'jpeg', quality: 0.98 }, html2canvas: { scale: 2 }, jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' } }
      html2pdf().set(opt).from(document.getElementById('finalArea')).save();
    }

    // Edit button logic
    document.getElementById('editBtn').onclick = () => {
      document.getElementById('wizardRoot').classList.remove('hidden');
      document.getElementById('finalWrap').classList.add('hidden');
    }
  </script>
</body>
</html>
